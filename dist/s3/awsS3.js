var cfg=require("../../../pbx_config"),fs=require("fs"),AWS=require("aws-sdk"),pbx_logger=require("../logger/pbx_logger.js"),request=require("request"),pbx_api=require("../api/pbx_api.js"),dt=require("../common/datetime.js"),cdr=require("../cdr"),logger=new pbx_logger,api=new pbx_api;function awsS3(){if(!(this instanceof awsS3))return new awsS3}module.exports=awsS3;const s3=new AWS.S3({accessKeyId:cfg.aws.access_key_id,secretAccessKey:cfg.aws.secret_access_key});awsS3.prototype.s3Upload=function(s,e,a,r,c){try{logger.log("IMP",s.channel.id,"awsS3","Internal Function [s3Upload]"),logger.log("DEB",s.channel.id,"awsS3","fileName["+a+"], bucket("+cfg.aws.bucket_name+"), folder("+e+"), fileName("+r+")");var o=fs.createReadStream(a),l={Bucket:cfg.aws.bucket_name,Key:e+"/"+r,Body:o};s3.upload(l,function(e,a){e&&(logger.log("ERR",s.channel.id,"awsS3","s3Upload failed, Error"+e),c(e,a)),c(null,a),logger.log("DEB",s.channel.id,"awsS3","s3Upload File uploaded successfully at:"+a.Location)})}catch(e){console.log(e)}};