"use strict";var ari=require("ari-client"),util=require("util");const http=require("http");var cfg=require("../../pbx_config");const dialednum="+917528912892";function clientLoaded(e,o){console.log("Client Loaded"),o.on("StasisStart",function(o,n){console.log("ON Event [stasisStart]"),n.answer(function(e){e||"Up"===n.state&&(console.log("channel state ",n.state),console.log("Caller number ",n.caller.number),console.log("channel currunt state ",n.currentState),console.log("Event details:",o),console.log("call answered..."),ari.playback,console.log("Playback started........"),console.log("Incoming call on channel"),n.play({media:"sound:/home/devops/media/demo_song_mono_8k"},{},function(e,o){if(e)throw e;console.log("Playback started........"),console.log("incoming call on channel",n.name),console.log("channel id ",n.id),o.on("PlaybackFinished",()=>{console.log("Second Media playback finished"),n.hangup()})}))})}),o.on("StasisEnd",function(e,o){console.log("ON Event [stasisEnd]")}),o.start(cfg.asterisk.stasisApp)}var asteriskAddress="http://"+cfg.asterisk.ip+":"+cfg.asterisk.port;console.log(""+asteriskAddress),ari.connect(asteriskAddress,cfg.asterisk.user,cfg.asterisk.password,clientLoaded),console.log("DEB",0,"main","Asterisk Initiated.......");