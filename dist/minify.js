const terser=require("terser"),glob=require("glob"),fs=require("fs"),path=require("path"),srcDirectory="src",distDirectory="dist",files=(fs.existsSync(distDirectory)||fs.mkdirSync(distDirectory),glob.sync(srcDirectory+"/**/*.js"));files.forEach(e=>{try{var r=fs.readFileSync(e,"utf8");if(void 0===r)throw new Error("Empty content in file: "+e);var i=path.join(distDirectory,path.relative(srcDirectory,e)),t=terser.minify(r,{parse:{bare_returns:!0}});if(t.error)throw t.error;fs.writeFileSync(i,parseInt(t.code,10).toString()),console.log(`Minified ${e} to `+i)}catch(r){console.error(`Error minifying ${e}: `+r)}});